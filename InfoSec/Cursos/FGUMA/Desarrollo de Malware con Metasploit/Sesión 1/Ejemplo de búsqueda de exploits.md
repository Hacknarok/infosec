---
tags: [aprendizaje]
---

# Planteamiento
> [!EXAMPLE] Sea un sitio web con [[Wordpress]]
> Se plantea encontrar sus vulnerabilidades, explotarlas y ejecutar [[Meterpreter]].
> 
> Para ello, se realizará una serie de comandos en [[Metasploit]] usando [[msfconsole]].

## Parámetros
Para este ejemplo, se parte con los siguientes datos.
- Máquina atacante: `192.168.56.1` -> Mi máquina local.
- Máquina víctima: `192.168.56.101` -> [[Máquina Virtual]] con [[Metasploitable 2]].
	-> Credenciales conocidas: `msfadmin:msfadmin` -> usuario y contraseña de `root`.

> [!IMPORTANT] Las máquinas están en la misma red.


# Ejecución
## 1 - Cargar un plugin de búsqueda de vulnerabilidades
**Comando:** `load <plugin>`

Un buen plugin es `wmap`, que se especializa en búsqueda de vulnerabilidades web, creado a partir de [[SQLmap]].

```shell
load wmap
```


## 2 - Dar de alta los sitios web que se quieran verificar
**Comando:** `wmap_sites -a <objetivo1> <objetivo2> <...>`

El *objetivo* corresponde con la dirección [[IP]] de la máquina que aloja el sitio web.
```shell
wmap_sites -a http://192.168.2.20
```

Además, pueden listarse los objetivos usando el parámetro `-l`.
```shell
wmap_sites -l
```


## 3 - Seleccionar el sitio con el que se quiere trabajar
**Comando:** `wmap_targets -d <identificador (Id)>`

El *identificador* aparece en la lista mostrada con `wmap_sites -l`.
```shell
wmap_targets -d 0
```

También puede indicarse una ruta concreta sobre la que hacer las pruebas.
```shell
wmap_targets -t http://192.168.2.20/blog
```

Además, pueden listarse los objetivos usando el parámetro `-l`.
```shell
wmap_targets -l
```


## 4 - Realizar las pruebas
Pueden listarse las pruebas antes de su ejecución para revisarlas.

```shell
wmap_run -t
```

Finalmente, para ejecutar las pruebas:

```shell
wmap_run -e
```


## 5 - Elegir un [[Exploit]]
### Listar las vulnerabilidades explotables
Tras la ejecución, pueden realizarse varias cosas:
- Listar las vulnerabilidades explotables.
```shell
vulns
```

- Observar puntos potenciales de ataque.
```shell
vmap_vulns -l
```


### Buscar los [[Exploit|Exploits]]
**Comando:** `search name:<nombre>`

Como el ejemplo consiste en un sistio web con [[Wordpress]], pueden buscarse todos los [[Exploit]] relacionados con él.
```shell
search name:wordpress
```

Al haberse encontrado las [[Vulnerabilidad|vulnerabilidades]] en el paso anterior, lo siguiente sería explotarlas.
Bastaría con encontrar los [[Exploit|Exploits]] compatibles con las [[Vulnerabilidad|vulnerabilidades]] de la lista anterior.
```shell
? ? ? ? ?
```
